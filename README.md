# Локальный build-pipeline.
Конвейер собирающий nginx в .deb пакеты, с поддержкой release/debug/coverage
версий сборки, генерирующий отчёты о проделанной работе

Данный конвейер был разработан с использованием Python 3.13.7,
Docker 29.1.3 в ОС Manjaro Linux (на основе Arch), ядро Linux 6.12.
Проверялся на 3 различных ОС: Kali Linux и Ubuntu 24.04 LTS Server и Manjaro.

## Зависимости:
Python 3.13.7, не тестировался на более ранних версиях
Docker 27 - 29, не тестировался на более ранних версиях

## Перед работой:
Не рекомендуется запускать с правами root, для работоспособности скрипта необходимо
добавить текущего пользователя в группу docker с помощью

1.
```bash
sudo groupadd docker (если группы нет)
sudo usermod -aG docker $USER
```
или

2.
```bash
newgrp docker
```
чтобы временно присвоить пользователю эту группу.

При первом варианте, необходимо перезапустить сессию для принятия изменений.

## Описание файловой структуры проекта:
```
InfoTecs/
├── scripts/
│   ├── build.sh          основной скрипт сборки nginx
│   ├── pipeline.py       оркестратор: проверка/сборка образа и контейнера
│   └── report_writer.sh  генерация билд отчётов
├── docker/
│   └── Dockerfile        рецепт для сборки образа
├── artifacts/            выходные .deb пакеты
├── src/
│   └── nginx/            исходный код nginx
├── reports/              директория для coverage отчётов
│   └── build/            директория для билд отчётов
└── run_build.py          точка входа для удобного запуска сборки
```
## Инструкция по использованию:
После установки зависимостей и добавления пользователя в группу docker,
просто запустить run_build.py с передачей аргумента из корня проекта, например
```python
python3 run_build <тип сборки>
```
## Доступные виды сборки:
```
release: сборка с оптимизацией и strip
debug: сборка с отладочными симвлоами
coverage: сборка с lcov, генерация отчёта о покрытии
```
После выполнения программы, .deb пакеты попадают в artifacts/
Конвейер выполняет очистку временно-используемых и временных директорий, а так же
очистку репозитория исходного кода с использованием make.
